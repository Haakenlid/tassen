; ==================================
;  Supervisord configuration
;  symlink this to this location:
;  /etc/supervisor/conf.d/USERNAME.conf
; ==================================


[group:SITEURL]
programs=SITEURL-gunicorn, SITEURL-celery-worker, SITEURL-celery-beat

; ==================================
[program:SITEURL-gunicorn]
command = /srv/SITEURL/bin/USERNAME_gunicorn.sh
user = USERNAME
autostart=true
startsecs=5
stdout_logfile = /srv/SITEURL/logs/gunicorn.log
stderr_logfile = /srv/SITEURL/logs/gunicorn.log
stopasgroup=true

; ==================================
[program:SITEURL-celery-worker]
command=/srv/SITEURL/venv/SITEURL/bin/celery worker -A core --loglevel=INFO
user = USERNAME
autostart=true
startsecs=5
stdout_logfile = /srv/SITEURL/logs/celery.log
stderr_logfile = /srv/SITEURL/logs/celery.log

; The directory to your Django project
directory = /srv/SITEURL/source/

; Need to wait for currently executing tasks to finish at shutdown.
; Increase this if you have very long running tasks.

stopwaitsecs = 60
stopasgroup=true
priority=998

; ==================================
[program:SITEURL-celery-beat]
command=/srv/SITEURL/venv/SITEURL/bin/celery celerybeat -A core --loglevel=INFO
user = USERNAME
autostart=true
startsecs=5
stdout_logfile = /srv/SITEURL/logs/celery.log
stderr_logfile = /srv/SITEURL/logs/celery.log

; The directory to your Django project
directory = /srv/SITEURL/source/

; Need to wait for currently executing tasks to finish at shutdown.
; Increase this if you have very long running tasks.

stopasgroup=true
priority=999